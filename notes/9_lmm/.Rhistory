knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
set.seed(13)
library(tidyverse)
library(tidyverse)
library(foreach)
library(doParallel)
library(betareg)
dat <- read.csv("~/research/online/manuscript/200_1105.csv", header = TRUE)[1:1105, ] %>%
rename(ObjExam = ObjectiveExam)
dat$ACT <- as.numeric(as.character(dat$ACT))
dat$ACTMajor <- as.numeric(as.character(dat$ACTMajor))
dat$ACTMath <- as.numeric(as.character(dat$ACTMath))
dat$ACTVerbal <- as.numeric(as.character(dat$ACTVerbal))
head(dat)
library(betareg)
dat_beta <- dat %>% mutate(Y = ObjExam / 100) %>%
dplyr::select(-ObjExam)
dat_beta$Y[which(dat_beta$Y == 1)] <- 0.9999
dat_beta$Y[which(dat_beta$Y == 0)] <- 0.0001
# standard model
m1 <- betareg(Y ~ Online + Gender + International + F17 + S18 + S19 +
FR + SO + JR + ACTMajor + ACT + ACTMath|Online + Gender +
International + F17 + S18 + S19 +
FR + SO + JR + ACTMajor + ACT + ACTMath, data = dat_beta)
# smaller model
m2 <- betareg(Y ~ Online + Gender + International + F17 + S18 + S19 +
FR + SO + JR + ACTMajor + ACT + ACTMath|ACTMath,
data = dat_beta)
# smaller model (different link functions)
m3 <- betareg(Y ~ Online + Gender + International + F17 + S18 + S19 +
FR + SO + JR + ACTMajor + ACT + ACTMath|ACTMath,
data = dat_beta, link = "log", link.phi = "sqrt")
plot(m3$fitted.values, residuals(m3), xlab = "fitted values",
ylab = "residuals")
lo <- loess(resid ~ fitted, data = fit_resid)
plot(m3$fitted.values, residuals(m3), xlab = "fitted values",
ylab = "residuals")
fit_resid <- data.frame(resid = residuals(m3),
fitted = m3$fitted.value)
lo <- loess(resid ~ fitted, data = fit_resid)
lines(seq(0.3,1,length=500),
predict(lo, data.frame(fitted = seq(from = 0.3, to = 1, length = 500))),
lty = 2, col = "red")
fit_resid
head(fit_resid)
fit_resid[1, ] > 4
fit_resid[, 1] > 4
fit_resid[fit_resid[, 1] > 4, ]
dat[fit_resid[, 1] > 4, ]
dat_foo <- cbind(dat, fit_resid)
dat_foo[fit_resid[, 1] > 4, ]
dat_foo$Final > 99.99
dat_foo[dat_foo$Final > 99.99, ]
dat_foo[fit_resid[, 1] > 4, ]
dat_foo[fit_resid[, 1] > 4, ] %>% select(Online, F17, S18, S19, Fa19, Fr, So, JR, ACT, ACTMajor, ACTMath, Final, Homework, resid)
dat_foo[fit_resid[, 1] > 4, ] %>% select(Online, F17, S18, S19, Fa19, Fr, SO, JR, ACT, ACTMajor, ACTMath, Final, Homework, resid)
dat_foo[fit_resid[, 1] > 4, ] %>% select(Online, F17, S18, S19, Fa19, FR, SO, JR, ACT, ACTMajor, ACTMath, Final, Homework, resid)
dat_foo[fit_resid[, 1] > 4, ] %>% select(Online, Gender, International, F17, S18, S19, Fa19, FR, SO, JR, ACT, ACTMajor, ACTMath, Final, Homework, resid)
?residuals
?betareg
logit(5)
logit <- function(x) log(x/(1-x))
logit(0.9999) - logit(0.73)
logit(0.9999)
logit(0.9999) - logit(0.73)
